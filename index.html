<!DOCTYPE html>
<html>
<head>
    <title>All-in-One Free Image Tools</title>
    <style>
        body { font-family: Arial; background: #f6f6f6; }
        .tab { display: none; background: #fff; margin: 15px auto; max-width: 460px; border-radius: 8px; box-shadow: 0 2px 8px #aaa; padding: 24px;}
        .tab.active { display: block;}
        .tab-btn { padding: 10px 18px; margin:4px; border: 1px solid #888; background: #eee; cursor:pointer;}
        .tab-btn.active { background: #3b82f6; color: #fff; }
        hr {margin: 25px 0 18px;}
    </style>
</head>
<body>
    <center>
        <h2>üõ†Ô∏è All-in-One Free Image Tools</h2>
        <div>
            <button class="tab-btn active" onclick="showTab('bg')">BG Remover</button>
            <button class="tab-btn" onclick="showTab('meme')">Meme Creator</button>
            <button class="tab-btn" onclick="showTab('avatar')">Avatar</button>
            <button class="tab-btn" onclick="showTab('palette')">Color Picker</button>
            <button class="tab-btn" onclick="showTab('upscale')">Image Upscaler</button>
        </div>
    </center>

    <!-- BG Remover -->
    <div class="tab active" id="bg">
        <h3>Background Remover</h3>
        <input type="file" id="bgFile" accept="image/*"><br><br>
        <button onclick="removeBG()">Remove Background</button>
        <canvas id="bgCanvas" width="320" height="320" style="display:block;margin:15px 0;"></canvas>
        <button onclick="downloadBG()">Download PNG</button>
        <br><small>(Works best on images with plain/white background!)</small>
    </div>

    <!-- Meme Generator -->
    <div class="tab" id="meme">
        <h3>Meme Generator</h3>
        <input type="file" id="memeInput" accept="image/*"><br>
        <input type="text" id="memeTop" placeholder="Top text"><br>
        <input type="text" id="memeBot" placeholder="Bottom text"><br>
        <button onclick="drawMeme()">Create Meme</button>
        <button onclick="downloadMeme()">Download Meme</button><br>
        <canvas id="memeCanvas" width="400" height="400" style="margin-top:10px;"></canvas>
    </div>

    <!-- Avatar Generator -->
    <div class="tab" id="avatar">
        <h3>Avatar Generator</h3>
        <input type="text" id="avatarText" maxlength="2" placeholder="Initials (2 chars)">
        <button onclick="drawAvatar()">Generate</button>
        <button onclick="downloadAvatar()">Download Avatar</button><br>
        <canvas id="avatarCanvas" width="120" height="120" style="margin-top:12px"></canvas>
    </div>

    <!-- Color Palette Generator -->
    <div class="tab" id="palette">
        <h3>Color Palette Generator</h3>
        <button onclick="genPalette()">Random Palette</button>
        <input type="file" id="imgForPalette" accept="image/*">
        <button onclick="imgPalette()">From Image</button>
        <div id="paletteBox" style="margin-top:10px;display:flex;"></div>
    </div>

    <!-- Upscale -->
    <div class="tab" id="upscale">
        <h3>Basic Image Upscaler</h3>
        <input type="file" id="upscaleIn" accept="image/*"><br>
        <label>Width: <input type="number" id="upWidth" value="600" style="width:60px;"></label>
        <label>Height: <input type="number" id="upHeight" value="600" style="width:60px;"></label><br>
        <button onclick="doUpscale()">Upscale</button>
        <button onclick="downloadUpscale()">Download</button><br>
        <canvas id="upCanvas" width="600" height="600" style="margin-top:10px;"></canvas>
    </div>

    <script>
    // Tab logic
    function showTab(id) {
        document.querySelectorAll('.tab').forEach(e=>e.classList.remove("active"));
        document.querySelectorAll('.tab-btn').forEach(e=>e.classList.remove("active"));
        document.getElementById(id).classList.add("active");
        document.querySelectorAll('.tab-btn')[["bg","meme","avatar","palette","upscale"].indexOf(id)].classList.add('active');
    }
    // BG Remover (white/solid bg only!)
    function removeBG() {
        const input = document.getElementById('bgFile');
        if(input.files.length===0) { alert("Upload image"); return;}
        const file = input.files[0];
        const canvas = document.getElementById('bgCanvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        const threshold = 210;
        const alphaVal = 10;
        img.onload = function(){
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.drawImage(img,0,0,canvas.width,canvas.height);
            let imgData = ctx.getImageData(0,0,canvas.width,canvas.height);
            for(let i=0;i<imgData.data.length;i+=4){
                // Detect light/white bg
                if(imgData.data[i] > threshold && imgData.data[i+1]>threshold && imgData.data[i+2] >threshold){
                    imgData.data[i+3] = alphaVal; // transparent
                }
            }
            ctx.putImageData(imgData,0,0);
        }
        img.src = URL.createObjectURL(file);
    }
    function downloadBG() {
        const link = document.createElement('a');
        link.download = 'bg-removed.png';
        link.href = document.getElementById('bgCanvas').toDataURL();
        link.click();
    }

    // Meme Generator
    let memeImg = new Image();
    document.getElementById('memeInput').addEventListener('change', function(e){
        const reader = new FileReader();
        reader.onload = function(evt){
            memeImg.src = evt.target.result;
            memeImg.onload = drawMeme;
        }
        reader.readAsDataURL(e.target.files[0]);
    });
    function drawMeme() {
        const canvas = document.getElementById('memeCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0,0,canvas.width,canvas.height);
        if(memeImg.src) ctx.drawImage(memeImg, 0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 4;
        ctx.fillStyle = "white";
        ctx.font = "bold 32px Arial";
        ctx.textAlign = "center";
        let top = document.getElementById('memeTop').value.toUpperCase();
        let bot = document.getElementById('memeBot').value.toUpperCase();
        ctx.strokeText(top, canvas.width/2, 44);
        ctx.fillText(top, canvas.width/2, 44);
        ctx.strokeText(bot, canvas.width/2, canvas.height-20);
        ctx.fillText(bot, canvas.width/2, canvas.height-20);
    }
    function downloadMeme() {
        const link = document.createElement('a');
        link.download = 'meme.png';
        link.href = document.getElementById('memeCanvas').toDataURL();
        link.click();
    }

    // Avatar Generator
    function drawAvatar() {
        const canvas = document.getElementById('avatarCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0,0,canvas.width,canvas.height);
        let txt = document.getElementById('avatarText').value.slice(0,2).toUpperCase() || 'AI';
        let bg = "#"+Math.floor(Math.random()*16777215).toString(16);
        ctx.fillStyle = bg;
        ctx.beginPath();
        ctx.arc(60,60,55,0,2*Math.PI);
        ctx.fill();
        ctx.fillStyle = "#fff";
        ctx.font = "bold 48px Arial";
        ctx.textAlign = "center";
        ctx.fillText(txt, 60, 80);
    }
    function downloadAvatar() {
        const link = document.createElement('a');
        link.download = 'avatar.png';
        link.href = document.getElementById('avatarCanvas').toDataURL();
        link.click();
    }

    // Color Palette
    function genPalette() {
        let box = document.getElementById('paletteBox');
        box.innerHTML = '';
        for(let i=0;i<5;i++){
            let c = "#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,'0');
            let d = document.createElement('div');
            d.style.width="50px";d.style.height="50px";
            d.style.margin="0 7px"; d.style.background=c;
            d.title=c;
            d.innerHTML='<span style="font-size:11px;color:#222;">'+c+'</span>';
            box.appendChild(d);
        }
    }
    function imgPalette() {
        const input = document.getElementById('imgForPalette');
        if(input.files.length===0){alert("Upload image");return;}
        const imgFile = input.files[0];
        const img = new Image();
        img.onload = function(){
            const palette = {};
            // resize small for speed
            let canvas = document.createElement("canvas");
            canvas.width=32;canvas.height=32;
            let ctx=canvas.getContext("2d");
            ctx.drawImage(img,0,0,32,32);
            let data=ctx.getImageData(0,0,32,32).data;
            for(let i=0;i<data.length;i+=4){
                let r = data[i], g = data[i+1], b = data[i+2];
                let color = "#"+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('');
                palette[color]=(palette[color]||0)+1;
            }
            let sorted = Object.keys(palette).sort((a,b)=>palette[b]-palette[a]).slice(0,5);
            let box = document.getElementById('paletteBox');
            box.innerHTML='';
            sorted.forEach(c=>{
                let d=document.createElement('div');
                d.style.width="50px";d.style.height="50px";
                d.style.margin="0 7px"; d.style.background=c;
                d.title=c;
                d.innerHTML='<span style="font-size:11px;color:#222;">'+c+'</span>';
                box.appendChild(d);
            });
        }
        img.src = URL.createObjectURL(imgFile);
    }

    // Image Upscaler (basic size change, not AI)
    let upImg = new Image();
    document.getElementById('upscaleIn').addEventListener('change',function(e){
        const f = e.target.files[0];
        if (f) {
            upImg.src = URL.createObjectURL(f);
            upImg.onload = ()=>doUpscale();
        }
    });
    function doUpscale() {
        const w = parseInt(document.getElementById('upWidth').value) || 600;
        const h = parseInt(document.getElementById('upHeight').value) || 600;
        const canvas = document.getElementById('upCanvas');
        canvas.width = w; canvas.height = h;
        let ctx = canvas.getContext('2d');
        if(upImg.src) ctx.drawImage(upImg, 0, 0, w, h);
    }
    function downloadUpscale() {
        const link = document.createElement('a');
        link.download = 'upscaled.png';
        link.href = document.getElementById('upCanvas').toDataURL();
        link.click();
    }
    </script>
</body>
</html>
